more nested loops, more functions
